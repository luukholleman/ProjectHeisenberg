<link rel="import" href="../bower/polymer/polymer.html">

<polymer-element name="timeline-now" attributes="timeSpanStart timeSpanEnd">
    <template>
        <style>
            :host, .bubble {
                position: absolute;
                width: 0px;
                height: 0;
                margin: 0 0;
                padding: 0;
            }

            .bubble {
                display: inline-block;
                vertical-align: top;
                overflow: visible;
            }

            .entry-info {
                overflow: visible;
                color: #9a9a9a;
                font-size: 12px;
                text-align: center;
                border-radius: 8px;
                font-style: italic;
                width: 64px;
                height: 16px;
                position: relative;
                left: -32px;
            }

            .bubble:after {
                content: '';
                display: block;
                background: #009688;
                width: 9px;
                height: 9px;
                border-radius: 7px;
                border: 2px solid #06182E;
                position: absolute;
                left: 50%;
                top: -25px;
                margin-left: -7px;
            }
            .entry-info:before {
                content: '';
                display: block;
                background: #9a9a9a;
                width: 3px;
                height: 20px;
                position: absolute;
                left: 50%;
                top: -20px;
                margin-left: -2px;
            }
        </style>
        <div class="bubble">
            <div class="entry-info">
                now
            </div>
        </div>
    </template>
    <script>
        Polymer('timeline-now', {
            timeSpanStart: 0,
            timeSpanEnd: 0,
            lineWidth: 0,
            timeSpanStartChanged: function () {
                this.update();
            },
            timeSpanEndChanged: function () {
                this.update();
            },
            lineWidthChanged: function() {
                this.update();
            },
            update:function(){
                var now = new Date().getTime() / 1000;
                var perc = (now - this.timeSpanStart) / (this.timeSpanEnd - this.timeSpanStart);
                this.style.display = now >= this.timeSpanStart && now <= this.timeSpanEnd ? 'block' : 'none';
                this.style.left = Math.round(perc * this.lineWidth) + 'px';
            },
            ready:function(){
                this.update();
            }
        });
    </script>

</polymer-element>